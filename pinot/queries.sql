SELECT COUNT(*) FROM hits;
SELECT COUNT(*) FROM hits WHERE AdvEngineID <> 0;
SELECT SUM(AdvEngineID), COUNT(*), AVG(ResolutionWidth) FROM hits;
SELECT AVG(UserID) FROM hits;
SELECT COUNT(DISTINCT UserID) FROM hits;
SELECT COUNT(DISTINCT SearchPhrase) FROM hits;
SELECT ToDateTime(MIN(processedEventDate) * 86400000, 'yyyy-MM-dd') as Min_processedEventDate, ToDateTime(MAX(processedEventDate) * 86400000, 'yyyy-MM-dd') as Max_processedEventDate FROM hits;
SELECT AdvEngineID, COUNT(*) FROM hits WHERE AdvEngineID <> 0 GROUP BY AdvEngineID ORDER BY COUNT(*) DESC LIMIT 20;
SELECT RegionID, COUNT(DISTINCT UserID) AS u FROM hits GROUP BY RegionID ORDER BY u DESC LIMIT 10;
SELECT RegionID, SUM(AdvEngineID), COUNT(*) AS c, AVG(ResolutionWidth), COUNT(DISTINCT UserID) FROM hits GROUP BY RegionID ORDER BY c DESC LIMIT 10;
SELECT MobilePhoneModel, COUNT(DISTINCT UserID) AS u FROM hits WHERE MobilePhoneModel <> 'null' GROUP BY MobilePhoneModel ORDER BY u DESC LIMIT 10;
SELECT MobilePhone, MobilePhoneModel, COUNT(DISTINCT UserID) AS u FROM hits WHERE MobilePhoneModel <> 'null' GROUP BY MobilePhone, MobilePhoneModel ORDER BY u DESC LIMIT 10;
SELECT SearchPhrase, COUNT(*) AS c FROM hits WHERE SearchPhrase <> 'null' GROUP BY SearchPhrase ORDER BY c DESC LIMIT 10;
SELECT SearchPhrase, COUNT(DISTINCT UserID) AS u FROM hits WHERE SearchPhrase <> 'null' GROUP BY SearchPhrase ORDER BY u DESC LIMIT 10;
SELECT SearchEngineID, SearchPhrase, COUNT(*) AS c FROM hits WHERE SearchPhrase <> 'null' GROUP BY SearchEngineID, SearchPhrase ORDER BY c DESC LIMIT 10;
SELECT UserID, COUNT(*) FROM hits GROUP BY UserID ORDER BY COUNT(*) DESC LIMIT 10;
SELECT UserID, SearchPhrase, COUNT(*) FROM hits GROUP BY UserID, SearchPhrase ORDER BY COUNT(*) DESC LIMIT 10;
SET numGroupsLimit = '1000000'; SELECT UserID, SearchPhrase, COUNT(*) FROM hits GROUP BY UserID, SearchPhrase LIMIT 10;
SET numGroupsLimit = '1000000'; SELECT UserID, MINUTE(processedEventTime * 1000) AS m, SearchPhrase, COUNT(*) AS count FROM hits GROUP BY UserID, m, SearchPhrase ORDER BY count DESC LIMIT 10;
SELECT UserID FROM hits WHERE UserID = 435090932899640449;
SELECT COUNT(*) FROM hits WHERE TEXT_MATCH(URL, '/.*google.*/');
SELECT SearchPhrase, MINSTRING(URL), COUNT(*) AS c FROM hits WHERE TEXT_MATCH(URL, '/.*google.*/') AND SearchPhrase <> 'null' GROUP BY SearchPhrase ORDER BY c DESC LIMIT 10;
SELECT SearchPhrase, MINSTRING(URL), MINSTRING(Title), COUNT(*) AS c, COUNT(DISTINCT UserID) FROM hits WHERE TEXT_MATCH(Title, '/.*Google.*/') AND NOT TEXT_MATCH(URL, '/.*google.*/') AND SearchPhrase <> 'null' GROUP BY SearchPhrase ORDER BY c DESC LIMIT 10;
SELECT * FROM hits WHERE TEXT_MATCH(URL, '/.*google.*/') ORDER BY EventTime LIMIT 10;
SELECT SearchPhrase FROM hits WHERE SearchPhrase <> 'null' ORDER BY EventTime LIMIT 10;
SELECT SearchPhrase FROM hits WHERE SearchPhrase <> 'null' ORDER BY SearchPhrase LIMIT 10;
SELECT SearchPhrase FROM hits WHERE SearchPhrase <> 'null' ORDER BY EventTime, SearchPhrase LIMIT 10;
SELECT CounterID, AVG(length(URL)) AS l, COUNT(*) AS c FROM hits WHERE URL <> 'null' GROUP BY CounterID HAVING COUNT(*) > 100000 ORDER BY l DESC LIMIT 25;
SELECT REGEXP_REPLACE(Referer, '^https?://(?:www\.)?([^/]+)/.*$', '\1') AS k, AVG(length(Referer)) AS l, COUNT(*) AS c, MINSTRING(Referer) FROM hits WHERE Referer <> 'null' GROUP BY k HAVING COUNT(*) > 100000 ORDER BY l DESC LIMIT 25;
SELECT SUMINT(ResolutionWidth), SUMINT(ResolutionWidth) + COUNT(*), SUMINT(ResolutionWidth) + 2 * COUNT(*), SUMINT(ResolutionWidth) + 3 * COUNT(*), SUMINT(ResolutionWidth) + 4 * COUNT(*), SUMINT(ResolutionWidth) + 5 * COUNT(*), SUMINT(ResolutionWidth) + 6 * COUNT(*), SUMINT(ResolutionWidth) + 7 * COUNT(*), SUMINT(ResolutionWidth) + 8 * COUNT(*), SUMINT(ResolutionWidth) + 9 * COUNT(*), SUMINT(ResolutionWidth) + 10 * COUNT(*), SUMINT(ResolutionWidth) + 11 * COUNT(*), SUMINT(ResolutionWidth) + 12 * COUNT(*), SUMINT(ResolutionWidth) + 13 * COUNT(*), SUMINT(ResolutionWidth) + 14 * COUNT(*), SUMINT(ResolutionWidth) + 15 * COUNT(*), SUMINT(ResolutionWidth) + 16 * COUNT(*), SUMINT(ResolutionWidth) + 17 * COUNT(*), SUMINT(ResolutionWidth) + 18 * COUNT(*), SUMINT(ResolutionWidth) + 19 * COUNT(*), SUMINT(ResolutionWidth) + 20 * COUNT(*), SUMINT(ResolutionWidth) + 21 * COUNT(*), SUMINT(ResolutionWidth) + 22 * COUNT(*), SUMINT(ResolutionWidth) + 23 * COUNT(*), SUMINT(ResolutionWidth) + 24 * COUNT(*), SUMINT(ResolutionWidth) + 25 * COUNT(*), SUMINT(ResolutionWidth) + 26 * COUNT(*), SUMINT(ResolutionWidth) + 27 * COUNT(*), SUMINT(ResolutionWidth) + 28 * COUNT(*), SUMINT(ResolutionWidth) + 29 * COUNT(*), SUMINT(ResolutionWidth) + 30 * COUNT(*), SUMINT(ResolutionWidth) + 31 * COUNT(*), SUMINT(ResolutionWidth) + 32 * COUNT(*), SUMINT(ResolutionWidth) + 33 * COUNT(*), SUMINT(ResolutionWidth) + 34 * COUNT(*), SUMINT(ResolutionWidth) + 35 * COUNT(*), SUMINT(ResolutionWidth) + 36 * COUNT(*), SUMINT(ResolutionWidth) + 37 * COUNT(*), SUMINT(ResolutionWidth) + 38 * COUNT(*), SUMINT(ResolutionWidth) + 39 * COUNT(*), SUMINT(ResolutionWidth) + 40 * COUNT(*), SUMINT(ResolutionWidth) + 41 * COUNT(*), SUMINT(ResolutionWidth) + 42 * COUNT(*), SUMINT(ResolutionWidth) + 43 * COUNT(*), SUMINT(ResolutionWidth) + 44 * COUNT(*), SUMINT(ResolutionWidth) + 45 * COUNT(*), SUMINT(ResolutionWidth) + 46 * COUNT(*), SUMINT(ResolutionWidth) + 47 * COUNT(*), SUMINT(ResolutionWidth) + 48 * COUNT(*), SUMINT(ResolutionWidth) + 49 * COUNT(*), SUMINT(ResolutionWidth) + 50 * COUNT(*), SUMINT(ResolutionWidth) + 51 * COUNT(*), SUMINT(ResolutionWidth) + 52 * COUNT(*), SUMINT(ResolutionWidth) + 53 * COUNT(*), SUMINT(ResolutionWidth) + 54 * COUNT(*), SUMINT(ResolutionWidth) + 55 * COUNT(*), SUMINT(ResolutionWidth) + 56 * COUNT(*), SUMINT(ResolutionWidth) + 57 * COUNT(*), SUMINT(ResolutionWidth) + 58 * COUNT(*), SUMINT(ResolutionWidth) + 59 * COUNT(*), SUMINT(ResolutionWidth) + 60 * COUNT(*), SUMINT(ResolutionWidth) + 61 * COUNT(*), SUMINT(ResolutionWidth) + 62 * COUNT(*), SUMINT(ResolutionWidth) + 63 * COUNT(*), SUMINT(ResolutionWidth) + 64 * COUNT(*), SUMINT(ResolutionWidth) + 65 * COUNT(*), SUMINT(ResolutionWidth) + 66 * COUNT(*), SUMINT(ResolutionWidth) + 67 * COUNT(*), SUMINT(ResolutionWidth) + 68 * COUNT(*), SUMINT(ResolutionWidth) + 69 * COUNT(*), SUMINT(ResolutionWidth) + 70 * COUNT(*), SUMINT(ResolutionWidth) + 71 * COUNT(*), SUMINT(ResolutionWidth) + 72 * COUNT(*), SUMINT(ResolutionWidth) + 73 * COUNT(*), SUMINT(ResolutionWidth) + 74 * COUNT(*), SUMINT(ResolutionWidth) + 75 * COUNT(*), SUMINT(ResolutionWidth) + 76 * COUNT(*), SUMINT(ResolutionWidth) + 77 * COUNT(*), SUMINT(ResolutionWidth) + 78 * COUNT(*), SUMINT(ResolutionWidth) + 79 * COUNT(*), SUMINT(ResolutionWidth) + 80 * COUNT(*), SUMINT(ResolutionWidth) + 81 * COUNT(*), SUMINT(ResolutionWidth) + 82 * COUNT(*), SUMINT(ResolutionWidth) + 83 * COUNT(*), SUMINT(ResolutionWidth) + 84 * COUNT(*), SUMINT(ResolutionWidth) + 85 * COUNT(*), SUMINT(ResolutionWidth) + 86 * COUNT(*), SUMINT(ResolutionWidth) + 87 * COUNT(*), SUMINT(ResolutionWidth) + 88 * COUNT(*), SUMINT(ResolutionWidth) + 89 * COUNT(*) FROM hits;
SELECT SearchEngineID, ClientIP, COUNT(*) AS c, SUM(IsRefresh), AVG(ResolutionWidth) FROM hits WHERE SearchPhrase <> 'null' GROUP BY SearchEngineID, ClientIP ORDER BY c DESC LIMIT 10;
SELECT WatchID, ClientIP, COUNT(*) AS c, SUM(IsRefresh), AVG(ResolutionWidth) FROM hits WHERE SearchPhrase <> 'null' GROUP BY WatchID, ClientIP ORDER BY c DESC LIMIT 10;
SET numGroupsLimit = '1100000'; SELECT WatchID, ClientIP, COUNT(*) AS c, SUMINT(IsRefresh), AVG(ResolutionWidth) FROM hits GROUP BY WatchID, ClientIP ORDER BY c DESC LIMIT 10;
SELECT URL, COUNT(*) AS c FROM hits GROUP BY URL ORDER BY c DESC LIMIT 10;
SELECT 1, URL, COUNT(*) AS c FROM hits GROUP BY 1, URL ORDER BY c DESC LIMIT 10;
SELECT ClientIP, ClientIP - 1, ClientIP - 2, ClientIP - 3, COUNT(*) AS c FROM hits GROUP BY ClientIP, ClientIP - 1, ClientIP - 2, ClientIP - 3 ORDER BY c DESC LIMIT 10;
SELECT URL, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND DontCountHits = 0 AND IsRefresh = 0 AND URL <> 'null' GROUP BY URL ORDER BY PageViews DESC LIMIT 10;
SELECT Title, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND DontCountHits = 0 AND IsRefresh = 0 AND Title <> 'null' GROUP BY Title ORDER BY PageViews DESC LIMIT 10;
SELECT URL, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND IsRefresh = 0 AND IsLink <> 0 AND IsDownload = 0 GROUP BY URL ORDER BY PageViews DESC LIMIT 10 OFFSET 1000;
SELECT TraficSourceID, SearchEngineID, AdvEngineID, CASE WHEN (SearchEngineID = 0 AND AdvEngineID = 0) THEN Referer ELSE 'null' END AS Src, URL AS Dst, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND IsRefresh = 0 GROUP BY TraficSourceID, SearchEngineID, AdvEngineID, Src, Dst ORDER BY PageViews DESC LIMIT 10 OFFSET 1000;
SELECT URLHash, EventDate, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND IsRefresh = 0 AND TraficSourceID IN (-1, 6) AND RefererHash = 3594120000172545465 GROUP BY URLHash, EventDate ORDER BY PageViews DESC LIMIT 10 OFFSET 100;
SELECT WindowClientWidth, WindowClientHeight, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND IsRefresh = 0 AND DontCountHits = 0 AND URLHash = 2868770270353813622 GROUP BY WindowClientWidth, WindowClientHeight ORDER BY PageViews DESC LIMIT 10 OFFSET 10000;
SELECT toDateTime(dateTrunc('minute', processedEventTime, 'SECONDS', 'UTC', 'MILLISECONDS'),'yyyy-MM-dd HH:mm:ss') AS M, COUNT(*) AS PageViews FROM hits WHERE CounterID = 62 AND EventTime >= '2013-07-15 00:00:00' AND EventTime <= '2013-07-15 23:59:00' AND IsRefresh = 0 AND DontCountHits = 0 GROUP BY M ORDER BY M LIMIT 1000;